---
// src/pages/projects/[slug].astro

import MainLayout from "../../layouts/MainLayout.astro";
import { projects } from "../../data/projects";
import type { Project } from "../../data/projects";

import ProjectBoard from "../../components/ProjectBoard.astro";
import type { BoardBlock, BoardView } from "../../types/Board";
import * as DetaliBoard from "../../data/boards/detali";

// Все доски по slug проекта
const boardsBySlug: Record<
  string,
  { blocks: BoardBlock[]; initialView: BoardView }
> = {
  detali: DetaliBoard,
  // сюда добавишь остальные проекты:
  // "drugoy-slug": OtherBoard,
};

export function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

interface Props {
  project: Project;
}

const { project } = Astro.props as Props;

// может быть undefined, если для этого проекта доска ещё не задана
const boardData = boardsBySlug[project.slug];
---

<MainLayout title={project.title}>
  <!-- Фоновая доска (только если есть данные для этого проекта) -->
  {boardData && (
    <div class="project-board-background">
      <ProjectBoard
        blocks={boardData.blocks}
        initialView={boardData.initialView}
      />
    </div>
  )}

  <!-- Твой обычный контент страницы проекта -->
  <main class="project-content">
    <!-- <h1>{project.title}</h1> -->
    <!-- сюда потом добавишь текст, блоки и т.п. -->
  </main>
</MainLayout>
