---
// src/pages/projects/[slug].astro

import MainLayout from "../../layouts/MainLayout.astro";
import { projects, type Project } from "../../data/projects";

import ProjectBoard from "../../components/ProjectBoard.astro";
import type { BoardBlock, BoardView } from "../../types/Board";
import * as DetaliBoard from "../../data/boards/detali";

// словарь досок по slug проекта
const boardsBySlug: Record<string, { blocks: BoardBlock[]; initialView: BoardView }> = {
  detali: DetaliBoard,
};

export function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

type Props = {
  project: Project;
};

const { project } = Astro.props as Props;

// может быть undefined, если для проекта нет доски
const boardData = boardsBySlug[project.slug];
---

<MainLayout title={project.title}>
  {boardData && (
    <div class="project-board-background">
      <ProjectBoard
        blocks={boardData.blocks}
        initialView={boardData.initialView}
      />
    </div>
  )}

  <section class="project-content">
    <h1>{project.title}</h1>
    <p>{project.short}</p>
    <!-- сюда позже добавишь остальные блоки проекта -->
  </section>
</MainLayout>
